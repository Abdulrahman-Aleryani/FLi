{% extends "templates/web.html" %}
{% block title %}{{ _("Placement Test") }}{% endblock %}
{% block page_content %}
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    *{box-sizing:border-box}
    :root {
        --accent: #0b5fff;
        --accent-dark: #0947cc;
        --muted: #6b7280;
        --text-dark: #1a1a2e;
        --bg-light: #f8fafc;
        --radius: 12px;
        --max-width: 1180px;
    }
    
    body {
        font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        margin: 0;
        padding: 0;
    }
    
    [dir="rtl"] body,
    [dir="rtl"] .placement-wrapper {
        font-family: "Cairo", "Tajawal", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    
    /* Container */
    .container{max-width:var(--max-width);margin:0 auto;padding:0 20px;}
    
    /* Header/Navbar */
    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:18px 0;
      gap:16px;
      position:static;
      z-index:2100;
      background:transparent;
    }
    .header .logo img{height:130px;}
    .nav{display:flex;gap:24px;align-items:center}
    .header-actions{display:flex;align-items:center;gap:12px;margin-left:auto}
    .header-actions .btn,.header-actions .lang-switcher{white-space:nowrap}
    .nav a.nav-link{
      color:#1a1a2e;
      text-decoration:none;
      font-weight:500;
      font-size:15px;
      padding:8px 4px;
      position:relative;
      transition:color 0.2s;
    }
    .nav a.nav-link::after{
      content:'';
      position:absolute;
      bottom:0;
      left:0;
      width:0;
      height:2px;
      background:var(--accent);
      transition:width 0.2s;
    }
    .nav a.nav-link:hover{color:var(--accent)}
    .nav a.nav-link:hover::after{width:100%}
    .home-link{
      width:42px;
      height:42px;
      border-radius:50%;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      background:transparent;
      color:#0b5fff;
      border:2px solid rgba(11,95,255,0.2);
      transition:all 0.25s ease;
      text-decoration:none;
    }
    .home-link svg{width:20px;height:20px;stroke:currentColor;stroke-width:2;fill:none;}
    .home-link:hover{background:var(--accent);color:#fff;border-color:var(--accent);box-shadow:0 4px 14px rgba(11,95,255,0.3);}
    .btn{background:var(--accent);color:#fff;padding:10px 20px;border-radius:25px;text-decoration:none;font-weight:600;font-size:14px;transition:all 0.2s;box-shadow:0 2px 8px rgba(11,95,255,0.25)}
    .btn:hover{background:#0947cc;transform:translateY(-1px);box-shadow:0 4px 12px rgba(11,95,255,0.35)}
    .lang-switcher{background:#f8fafc;border:none;padding:8px 14px;border-radius:20px;cursor:pointer;font-size:14px;color:#1a1a2e;font-weight:500;transition:all 0.2s}
    .lang-switcher:hover{background:var(--accent);color:#fff}

    /* Footer */
    .footer{padding:30px 0;border-top:1px solid #eef2f7;color:var(--muted)}
    .footer img{display:block}
    [dir="rtl"] .footer > div:first-child{flex-direction:row-reverse}

    [dir="rtl"] .header{
        flex-direction:row-reverse;
    }
    [dir="rtl"] .nav{
        flex-direction:row-reverse;
    }
    [dir="rtl"] .nav a.nav-link{
        text-align:right;
    }
    [dir="rtl"] .nav a.nav-link::after{
        left:auto;
        right:0;
    }
    [dir="rtl"] .home-link{
        flex-direction:row-reverse;
    }
    [dir="rtl"] .home-link svg{
        transform:scaleX(-1);
    }

    /* Hamburger Menu */
    .hamburger{
      display:none;
      background:none;
      border:none;
      cursor:pointer;
      padding:8px;
      flex-direction:column;
      gap:5px;
    }
    .hamburger span{
      display:block;
      width:24px;
      height:3px;
      background:#0b5fff;
      border-radius:2px;
      transition:all 0.3s;
    }
    .hamburger.active span:nth-child(1){transform:rotate(45deg) translate(6px,6px)}
    .hamburger.active span:nth-child(2){opacity:0}
    .hamburger.active span:nth-child(3){transform:rotate(-45deg) translate(6px,-6px)}

    .mobile-menu{
      display:none;
      position:absolute;
      top:100%;
      left:0;
      right:0;
      background:#fff;
      box-shadow:0 10px 30px rgba(0,0,0,0.1);
      border-radius:0 0 16px 16px;
      padding:20px;
      flex-direction:column;
      gap:12px;
      z-index:1000;
    }
    .mobile-menu.active{display:flex}
    .mobile-menu a{
      display:block;
      padding:12px 16px;
      color:#1a1a2e;
      text-decoration:none;
      font-weight:500;
      font-size:16px;
      border-radius:10px;
      transition:all 0.2s;
    }
    .mobile-menu a:hover{background:#f8fafc;color:var(--accent)}
    .mobile-menu .btn{
      text-align:center;
      margin-top:8px;
      color: white;
    }
    .mobile-menu .lang-switcher{
      width:100%;
      margin-top:8px;
    }
    .mobile-menu .home-link{
      width:100%;
      height:auto;
      padding:12px 16px;
      border-radius:10px;
      justify-content:flex-start;
      gap:12px;
    }
    .mobile-menu .home-link svg{
      width:20px;
      height:20px;
    }
    
    /* RTL adjustments for header */
    [dir="rtl"] .nav a.nav-link::after{left:auto;right:0}

    .placement-loader {
        width: 3rem;
        height: 3rem;
        margin: 0 auto;
        position: relative;
    }

    .placement-loader::before,
    .placement-loader::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 999px;
        border: 3px solid rgba(11, 95, 255, 0.15);
    }

    .placement-loader::after {
        border-color: var(--accent) transparent transparent transparent;
        animation: placement-spin 0.85s linear infinite;
    }

    @keyframes placement-spin {
        to {
            transform: rotate(360deg);
        }
    }

    .placement-loading-state p {
        color: var(--muted);
    }
    
    .placement-page {
        min-height: 80vh;
        padding: 60px 0;
        background: linear-gradient(135deg, #f8fafc 0%, #e8f4fd 100%);
    }
    
    .placement-container {
        max-width: 900px;
        margin: 0 auto;
        padding: 0 20px;
    }

    /* Info Section Styles */
    .placement-info-section {
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(9, 30, 66, 0.08);
        padding: 40px;
        margin-bottom: 30px;
        text-align: left;
        direction: ltr;
    }
    
    [dir="rtl"] .placement-info-section {
        text-align: right;
        direction: rtl;
    }

    .info-hero {
        text-align: center;
        margin-bottom: 40px;
        padding-bottom: 30px;
        border-bottom: 2px solid rgba(11, 95, 255, 0.1);
    }

    .info-main-title {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-dark);
        margin: 0 0 16px;
        line-height: 1.4;
    }

    .info-subtitle {
        font-size: 18px;
        color: var(--muted);
        margin: 0;
        line-height: 1.6;
    }

    .info-block {
        margin-bottom: 32px;
        padding-bottom: 24px;
        border-bottom: 1px solid rgba(11, 95, 255, 0.08);
    }

    .info-block:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
    }

    .info-block-title {
        font-size: 20px;
        font-weight: 700;
        color: var(--accent);
        margin: 0 0 16px;
    }

    .info-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .info-list li {
        position: relative;
        padding-left: 24px;
        margin-bottom: 12px;
        font-size: 16px;
        color: var(--text-dark);
        line-height: 1.6;
    }

    .info-list li::before {
        content: "â€¢";
        position: absolute;
        left: 0;
        color: var(--accent);
        font-weight: bold;
        font-size: 18px;
    }
    
    [dir="rtl"] .info-list li {
        padding-left: 0;
        padding-right: 24px;
    }
    
    [dir="rtl"] .info-list li::before {
        left: auto;
        right: 0;
    }

    .info-steps {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .info-steps li {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        margin-bottom: 14px;
        font-size: 16px;
        color: var(--text-dark);
        line-height: 1.6;
        flex-direction: row;
    }
    
    [dir="rtl"] .info-steps li {
        flex-direction: row-reverse;
    }

    .step-icon {
        flex-shrink: 0;
        font-size: 18px;
    }

    .info-note {
        background: linear-gradient(135deg, rgba(11, 95, 255, 0.08), rgba(11, 95, 255, 0.04));
        padding: 14px 20px;
        border-radius: 12px;
        font-size: 16px;
        color: var(--accent);
        font-weight: 600;
        margin-top: 16px;
        text-align: center;
    }

    .info-note-small {
        font-size: 14px;
        color: var(--muted);
        margin-top: 12px;
        font-style: italic;
    }

    .levels-block {
        background: linear-gradient(135deg, rgba(11, 95, 255, 0.04), rgba(232, 244, 253, 0.5));
        border-radius: 16px;
        padding: 24px;
        border: none;
    }

    .levels-category-title {
        font-size: 16px;
        font-weight: 600;
        color: #1a1a2e;
        margin: 20px 0 12px 0;
        padding-bottom: 8px;
        border-bottom: 2px solid rgba(11, 95, 255, 0.2);
    }

    .levels-category-title:first-of-type {
        margin-top: 0;
    }

    .levels-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        justify-content: center;
    }

    .level-item {
        background: #fff;
        border: 2px solid rgba(11, 95, 255, 0.15);
        border-radius: 12px;
        padding: 14px 24px;
        text-align: center;
        transition: all 0.2s ease;
    }

    .level-item:hover {
        border-color: var(--accent);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(11, 95, 255, 0.15);
    }

    .level-name {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-dark);
    }

    @media (max-width: 600px) {
        .placement-info-section {
            padding: 24px 20px;
        }

        .info-main-title {
            font-size: 24px;
        }

        .info-subtitle {
            font-size: 16px;
        }

        .info-block-title {
            font-size: 18px;
        }

        .levels-grid {
            flex-direction: column;
        }

        .level-item {
            width: 100%;
        }
        
        /* Mobile RTL/LTR styling */
        .placement-info-section,
        .test-selection,
        .test-info,
        .result-summary,
        .confirmation-message {
            direction: ltr;
            text-align: left;
        }
        
        [dir="rtl"] .placement-info-section,
        [dir="rtl"] .test-selection,
        [dir="rtl"] .test-info,
        [dir="rtl"] .result-summary,
        [dir="rtl"] .confirmation-message {
            direction: rtl;
            text-align: right;
        }
    }
    
    .placement-card {
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(9, 30, 66, 0.08);
        overflow: hidden;
        border: none;
    }
    
    .placement-header {
        background: linear-gradient(135deg, var(--text-dark) 0%, #16213e 100%);
        padding: 30px;
        text-align: center;
    }
    
    .placement-header h3 {
        color: #fff;
        margin: 0;
        font-size: 28px;
        font-weight: 700;
    }
    
    .placement-header p {
        color: rgba(255,255,255,0.8);
        margin: 10px 0 0;
        font-size: 16px;
    }
    
    .placement-body {
        padding: 40px;
    }
    
    .btn-primary-custom {
        background: var(--accent);
        color: #fff;
        padding: 12px 28px;
        border-radius: 25px;
        font-weight: 600;
        font-size: 15px;
        border: none;
        transition: all 0.2s;
        box-shadow: 0 4px 12px rgba(11, 95, 255, 0.25);
        text-decoration: none;
        display: inline-block;
    }
    
    .btn-primary-custom:hover {
        background: var(--accent-dark);
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(11, 95, 255, 0.35);
        color: #fff;
    }
    
    .btn-secondary-custom {
        background: transparent;
        color: var(--text-dark);
        padding: 12px 28px;
        border-radius: 25px;
        font-weight: 600;
        font-size: 15px;
        border: 2px solid #e5e7eb;
        transition: all 0.2s;
        text-decoration: none;
        display: inline-block;
    }
    
    .btn-secondary-custom:hover {
        border-color: var(--accent);
        color: var(--accent);
    }
    
    /* Responsive */
    @media (max-width:900px){
      .header{flex-wrap:wrap;gap:12px}
      .nav{flex-wrap:wrap;gap:10px;justify-content:center}
    }
    @media (max-width:600px){
      .container{padding:0 24px}
      .header{
        padding:6px 0;
        flex-direction:row;
        position:static;
        box-shadow:none;
      }
      .header .logo img{height:70px}
      .nav{display:none}
      .hamburger{display:flex}
      .header-actions{margin-left:auto;gap:6px}
      .header-actions .btn{padding:6px 12px;font-size:12px;border-radius:18px}
      .header-actions .lang-switcher{padding:4px 10px;font-size:12px}
      [dir="rtl"] .header-actions{margin-left:0;margin-right:auto}
      .placement-page{padding:30px 0}
      .placement-header{padding:24px 20px}
      .placement-header h3{font-size:22px}
      .placement-body{padding:24px 20px}
    }
</style>

<div class="placement-wrapper" id="placement-wrapper">
<!-- Navbar -->
<header class="container header">
  <div class="logo" style="display: flex; align-items: center;"><img src="/files/flipng.png" alt="Institute Logo" style="height:130px"></div>
  <nav class="nav">
    <a href="/" class="home-link" aria-label="Home">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M3 11.5 12 4l9 7.5" />
        <path d="M5 10.5V20h14v-9.5" />
      </svg>
    </a>
    <a href="/about" class="nav-link" data-i18n="nav_about">{{ _("About") }}</a>
    <a href="/contact" class="nav-link" data-i18n="nav_contact">{{ _("Contact") }}</a>
  </nav>
  <div class="header-actions">
    <button class="lang-switcher" onclick="toggleLanguage()">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
    <a href="/login" class="btn" data-i18n="nav_login">{{ _("Login") }}</a>
  </div>
  <button class="hamburger" onclick="toggleMobileMenu()" aria-label="Menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <div class="mobile-menu" id="mobileMenu">
    <a href="/" class="nav-link" aria-label="Home" data-i18n="nav_home">{{ _("Home") }}</a>
    <a href="/about" class="nav-link" data-i18n="nav_about">{{ _("About") }}</a>
    <a href="/contact" class="nav-link" data-i18n="nav_contact">{{ _("Contact") }}</a>
  </div>
</header>

<div class="placement-page">
    <div class="placement-container">
        <!-- Info Section -->
        <div class="placement-info-section">
            <div class="info-hero">
                <h1 class="info-main-title" data-i18n="placement_main_title">Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</h1>
                <p class="info-subtitle" data-i18n="placement_subtitle">Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„ÙƒØŒ ÙˆØªØ¹Ù„Ù‘Ù… Ø¨Ø«Ù‚Ø© ÙˆÙ…Ù†Ù‡Ø¬ÙŠØ© ØµØ­ÙŠØ­Ø©.</p>
            </div>

            <div class="info-block">
                <h2 class="info-block-title" data-i18n="placement_why_title">Ù„Ù…Ø§Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ù…Ù‡Ù…ØŸ</h2>
                <ul class="info-list">
                    <li data-i18n="placement_why_1">ÙŠØ­Ø¯Ø¯ Ù…Ø³ØªÙˆØ§Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ø¯Ù‚Ø©</li>
                    <li data-i18n="placement_why_2">ÙŠÙˆÙÙ‘Ø± Ø¹Ù„ÙŠÙƒ Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¬Ù‡Ø¯</li>
                    <li data-i18n="placement_why_3">ÙŠØ¶Ø¹Ùƒ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</li>
                </ul>
            </div>

            <div class="info-block">
                <h2 class="info-block-title" data-i18n="placement_how_title">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŸ</h2>
                <ol class="info-steps">
                    <li><span class="step-icon">1ï¸âƒ£</span> <span data-i18n="placement_step_1">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</span></li>
                    <li><span class="step-icon">2ï¸âƒ£</span> <span data-i18n="placement_step_2">Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</span></li>
                    <li><span class="step-icon">3ï¸âƒ£</span> <span data-i18n="placement_step_3">Ù…Ù‚Ø§Ø¨Ù„Ø© Ù‚ØµÙŠØ±Ø© Ù…Ø¹ Ø£Ø­Ø¯ Ù…Ø¯Ø±Ù‘Ø³ÙŠ Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ù„ØªÙ‚ÙŠÙŠÙ… Ù…Ù‡Ø§Ø±Ø© Ø§Ù„ØªØ­Ø¯Ø«</span></li>
                    <li><span class="step-icon">4ï¸âƒ£</span> <span data-i18n="placement_step_4">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø¯Ù‚Ø©</span></li>
                </ol>
                <p class="info-note" data-i18n="placement_remote">ğŸ“ Ù…ØªØ§Ø­: Ø¹Ù† Ø¨ÙØ¹Ø¯ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</p>
            </div>

            <div class="info-block">
                <h2 class="info-block-title" data-i18n="placement_interview_title">Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªÙ‚ÙŠÙ‘Ù…Ù‡ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø©ØŸ</h2>
                <ul class="info-list">
                    <li data-i18n="placement_interview_1">Ø§Ù„Ø·Ù„Ø§Ù‚Ø© ÙÙŠ Ø§Ù„ØªØ­Ø¯Ø«</li>
                    <li data-i18n="placement_interview_2">Ø§Ù„Ù†Ø·Ù‚</li>
                    <li data-i18n="placement_interview_3">Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„</li>
                    <li data-i18n="placement_interview_4">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª</li>
                </ul>
                <p class="info-note-small" data-i18n="placement_interview_note">Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© ØªÙ‡Ø¯Ù Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŒ ÙˆÙ„ÙŠØ³Øª Ø§Ù…ØªØ­Ø§Ù†Ù‹Ø§ Ø±Ø³Ù…ÙŠÙ‹Ø§.</p>
            </div>

            <div class="info-block levels-block">
                <h2 class="info-block-title" data-i18n="placement_levels_title">Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªÙŠ ÙŠØºØ·ÙŠÙ‡Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h2>
                
                <!-- Beginner Test Levels -->
                <h3 class="levels-category-title" data-i18n="levels_beginner_title">Levels covered by Beginner test:</h3>
                <div class="levels-grid">
                    <div class="level-item">
                        <span class="level-name">Access A-B</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">Basic A-B</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">Level 1 A-B</span>
                    </div>
                </div>

                <!-- Intermediate Test Levels -->
                <h3 class="levels-category-title" data-i18n="levels_intermediate_title">Levels covered by Intermediate test:</h3>
                <div class="levels-grid">
                    <div class="level-item">
                        <span class="level-name">WIT1</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">Level 2 A-B</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">WIT2</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">Level 3 A-B</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">WIT3</span>
                    </div>
                </div>

                <!-- Graduation Test Levels -->
                <h3 class="levels-category-title" data-i18n="levels_graduation_title">Levels covered by Graduation test:</h3>
                <div class="levels-grid">
                    <div class="level-item">
                        <span class="level-name">Level 4 A-B</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">WIT4.A</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">Level 5 A-B</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">WIT4.A</span>
                    </div>
                    <div class="level-item">
                        <span class="level-name">Level 6 A-B</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="placement-card">
            <div class="placement-header">
                <h3>{{ _("Placement Test") }}</h3>
                <p>{{ _("Discover your English level") }}</p>
            </div>
            <div class="placement-body">
                <div id="placement-test-container">
                    <!-- Content will be loaded here by JavaScript -->
                    <div class="text-center py-5 placement-loading-state" id="loading">
                        <div class="placement-loader" role="status" aria-live="polite">
                            <span class="visually-hidden">{{ _("Loading...") }}</span>
                        </div>
                        <p class="mt-3">{{ _("Loading placement test...") }}</p>
                    </div>
                </div>
            </div>
        </div>
    <footer class="container footer">
  <div style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:32px;align-items:flex-start">
    <div>
      <img src="/files/flipng.png" alt="logo" style="height:130px">
      <div style="color:var(--muted);font-size:14px;margin-top:8px" data-i18n="footer_address">Faculty Language Institute (FLI)</div>
      <a href="https://maps.app.goo.gl/i6p2srHHZGsf7V577" target="_blank" rel="noopener" style="display:flex;align-items:center;gap:8px;color:var(--muted);font-size:14px;text-decoration:none;margin-top:4px">
        <svg aria-hidden="true" focusable="false" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 3.25c-3.2 0-5.75 2.55-5.75 5.7 0 4.45 5.75 11.8 5.75 11.8s5.75-7.35 5.75-11.8c0-3.15-2.55-5.7-5.75-5.7Zm0 8.65a2.95 2.95 0 1 1 0-5.9 2.95 2.95 0 0 1 0 5.9Z" fill="currentColor"/>
        </svg>
        <span>Baghdad street, Sanaa, Yemen</span>
      </a>
      <div style="display:flex;align-items:center;gap:8px;color:var(--muted);font-size:14px;margin-top:8px">
        <svg aria-hidden="true" focusable="false" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4.5 6.75h15a1 1 0 0 1 1 1v8.5a1 1 0 0 1-1 1h-15a1 1 0 0 1-1-1v-8.5a1 1 0 0 1 1-1Z" stroke="currentColor" stroke-width="1.4" stroke-linejoin="round"/>
          <path d="M4.5 7.5 12 12.5l7.5-5" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>facultyinstitutefli@gmail.com</span>
      </div>
      <div style="display:inline-flex;align-items:center;gap:8px;color:var(--muted);font-size:14px;margin-top:8px;line-height:1.4">
        <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.8 4.2c-.3.3-.5.7-.4 1.1.4 2 1.3 4 2.7 5.7a13.2 13.2 0 0 0 5.7 2.7c.4.1.8 0 1.1-.4l1-1a.8.8 0 0 0-.1-1.2l-1.8-1.2a.8.8 0 0 0-.9 0l-.9.6a.8.8 0 0 1-.8 0 9.2 9.2 0 0 1-3.3-3.3.8.8 0 0 1 0-.8l.6-.9a.8.8 0 0 0 0-.9L9.3 3.4a.8.8 0 0 0-1.2-.1l-1.3 1Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>00967 781 405 000</span>
      </div>
      <div style="display:flex;align-items:center;gap:16px;margin-top:12px">
        <a href="https://wa.me/967781405000" target="_blank" rel="noopener" title="WhatsApp" style="color:#25D366;text-decoration:none">
          <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
          </svg>
        </a>
         <a href="https://www.instagram.com/fli.institute?igsh=MWprY2E3Z3JjMHE3dg==" target="_blank" rel="noopener" title="Instagram" style="color:#E4405F;text-decoration:none">
          <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/>
          </svg>
           </a>
        <a href="https://www.facebook.com/share/17pTq7L5uM/?mibextid=LQQJ4d" target="_blank" rel="noopener" title="Facebook" style="color:#1877F2;text-decoration:none">
          <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
          </svg>
        </a>
      </div>
    </div>
    <div style="display:flex;flex-direction:column;gap:10px;min-width:180px;align-self:flex-start;margin-top:140px">
      <a href="/about" style="color:var(--text);text-decoration:none;font-weight:500" data-i18n="nav_about">About Us</a>
      <a href="/contact" style="color:var(--text);text-decoration:none;font-weight:500" data-i18n="nav_contact">Contact</a>
    </div>
  </div>
  <div style="text-align:center;margin-top:18px;color:var(--muted);font-size:13px">
    &copy; <span id="year-placement"></span> <span data-i18n="footer_copyright">Faculty Language Institute. All rights reserved.</span>
  </div>
</footer>
</div>
</div>
</div>
{% endblock %}
{% block script %}
<script>
frappe.ready(function() {
    // Global variables
    let currentQuestion = 0;
    let testData = null;
    let userAnswers = {};
    let timer = null;
    let timeLeft = 0;
    const DEFAULT_COUNTRY_NAME = "Yemen";
    let countryCodeOptions = [];
    let countryCodeLoadPromise = null;

    function sanitizeHtml(html) {
        if (!html) {
            return "";
        }
        const template = document.createElement("template");
        template.innerHTML = html;
        template.content.querySelectorAll("script, style").forEach((node) => node.remove());
        template.content.querySelectorAll("*").forEach((node) => {
            [...node.attributes].forEach((attr) => {
                if (attr.name.toLowerCase().startsWith("on")) {
                    node.removeAttribute(attr.name);
                }
            });
        });
        return template.innerHTML;
    }

    function fetchCountryCodes() {
        if (countryCodeOptions.length) {
            return Promise.resolve(countryCodeOptions);
        }
        if (countryCodeLoadPromise) {
            return countryCodeLoadPromise;
        }
        countryCodeLoadPromise = new Promise((resolve) => {
            frappe.call({
                method: "frappe.geo.country_info.get_country_timezone_info",
                callback: function(r) {
                    const info = r.message?.country_info || {};
                    countryCodeOptions = Object.keys(info)
                        .map((country) => {
                            const entry = info[country] || {};
                            if (!entry.isd) {
                                return null;
                            }
                            const isoCode = (entry.code || "").toLowerCase();
                            return {
                                name: country,
                                dial: entry.isd,
                                iso: isoCode,
                                flag: isoCode ? `https://flagcdn.com/24x18/${isoCode}.png` : "",
                            };
                        })
                        .filter(Boolean)
                        .sort((a, b) => a.name.localeCompare(b.name));
                    resolve(countryCodeOptions);
                },
                error: () => {
                    resolve([]);
                }
            });
        });
        return countryCodeLoadPromise;
    }

    function setupCountryCodeField(prefillDial) {
        const wrapper = document.getElementById("countryCodeField");
        if (!wrapper) {
            return;
        }
        wrapper.innerHTML = "";

        const label = document.createElement("label");
        label.className = "form-label";
        label.innerHTML = `${__("Country Code")} <span class="text-danger">*</span>`;
        wrapper.appendChild(label);

        const helper = document.createElement("div");
        helper.className = "form-text text-muted mt-1";
        helper.id = "countryCodeHelper";

        if (!countryCodeOptions.length) {
            const input = document.createElement("input");
            input.type = "text";
            input.className = "form-control";
            input.id = "countryCode";
            input.value = "+967";
            input.readOnly = true;
            wrapper.appendChild(input);
            helper.textContent = __("Country list unavailable. Defaulting to Yemen (+967).");
            wrapper.appendChild(helper);
            return;
        }

        const dropdown = document.createElement("div");
        dropdown.className = "country-code-dropdown";
        dropdown.innerHTML = `
            <button type="button" class="country-code-trigger" aria-haspopup="listbox" aria-expanded="false">
                <span class="flag-thumb"></span>
                <span class="country-code-text"></span>
                <span class="chevron">&#9662;</span>
            </button>
            <div class="country-code-menu d-none">
                <input type="search" class="form-control country-code-search" placeholder="${__('Search by country or code')}" aria-label="${__('Search country code')}">
                <div class="country-code-options" role="listbox"></div>
            </div>
        `;
        wrapper.appendChild(dropdown);

        const hiddenInput = document.createElement("input");
        hiddenInput.type = "hidden";
        hiddenInput.id = "countryCode";
        wrapper.appendChild(hiddenInput);
        wrapper.appendChild(helper);

        const trigger = dropdown.querySelector(".country-code-trigger");
        const triggerFlag = trigger.querySelector(".flag-thumb");
        const triggerText = trigger.querySelector(".country-code-text");
        const menu = dropdown.querySelector(".country-code-menu");
        const searchInput = menu.querySelector(".country-code-search");
        const optionsContainer = menu.querySelector(".country-code-options");

        let selected = countryCodeOptions.find((option) => option.dial === (prefillDial || "").trim());
        if (!selected) {
            selected = countryCodeOptions.find((option) => option.name === DEFAULT_COUNTRY_NAME) || countryCodeOptions[0];
        }

        const closeMenu = () => {
            menu.classList.add("d-none");
            dropdown.classList.remove("open");
            trigger.setAttribute("aria-expanded", "false");
        };

        const openMenu = () => {
            menu.classList.remove("d-none");
            dropdown.classList.add("open");
            trigger.setAttribute("aria-expanded", "true");
            searchInput.value = "";
            filterOptions("");
            searchInput.focus();
        };

        const updateSelected = (option) => {
            selected = option;
            hiddenInput.value = option.dial;
            triggerText.textContent = `${option.dial} â€” ${option.name}`;
            helper.textContent = `${option.name} (${option.dial})`;
            triggerFlag.innerHTML = option.flag
                ? `<img src="${option.flag}" alt="${option.name} ${__('flag')}" loading="lazy">`
                : "";
        };

        const filterOptions = (query) => {
            const normalized = query.trim().toLowerCase();
            optionsContainer.querySelectorAll(".country-code-option").forEach((optionBtn) => {
                const matches = optionBtn.dataset.search.includes(normalized);
                optionBtn.classList.toggle("d-none", !matches);
            });
        };

        trigger.addEventListener("click", () => {
            if (dropdown.classList.contains("open")) {
                closeMenu();
            } else {
                openMenu();
            }
        });

        searchInput.addEventListener("input", (event) => {
            filterOptions(event.target.value);
        });

        document.addEventListener("click", (event) => {
            if (!dropdown.contains(event.target)) {
                closeMenu();
            }
        });

        document.addEventListener("keydown", (event) => {
            if (event.key === "Escape") {
                closeMenu();
            }
        });

        countryCodeOptions.forEach((option) => {
            const optionBtn = document.createElement("button");
            optionBtn.type = "button";
            optionBtn.className = "country-code-option";
            optionBtn.dataset.value = option.dial;
            optionBtn.dataset.search = `${option.name} ${option.dial} ${option.iso}`.toLowerCase();
            optionBtn.innerHTML = `
                <span class="flag-thumb">
                    ${option.flag ? `<img src="${option.flag}" alt="${option.name} ${__('flag')}" loading="lazy">` : ""}
                </span>
                <div class="country-code-copy">
                    <span class="country-dial">${option.dial}</span>
                    <span class="country-name">${option.name}</span>
                </div>
            `;
            optionBtn.addEventListener("click", () => {
                updateSelected(option);
                closeMenu();
            });
            optionsContainer.appendChild(optionBtn);
        });

        updateSelected(selected);
    }

    function splitPhoneWithCode(value) {
        if (!value) {
            return {
                code: "",
                number: "",
            };
        }
        const trimmed = value.trim();
        const regexMatch = trimmed.match(/^(\+\d+)(.*)$/);
        if (regexMatch) {
            return {
                code: regexMatch[1].trim(),
                number: (regexMatch[2] || "").trim(),
            };
        }
        const parts = trimmed.split(/\s+/);
        return {
            code: parts.shift() || "",
            number: parts.join(" ").trim(),
        };
    }

    function initializeParticipantForm() {
        const storedInfo = loadSubmissionInfo();
        if (storedInfo) {
            $("#fullName").val(storedInfo.fullName || "");
            $("#dateOfBirth").val(storedInfo.dateOfBirth || "");
            $("#email").val(storedInfo.email || "");
            $("#interviewTime").val(storedInfo.interviewTime || "");
        }

        const phoneParts = splitPhoneWithCode(storedInfo?.phone);

        const wrapper = document.getElementById("countryCodeField");
        if (wrapper) {
            wrapper.innerHTML = `
                <label class="form-label">${__('Country Code')} <span class="text-danger">*</span></label>
                <div class="placeholder-country-code text-muted small">${__('Loading country codes...')}</div>
            `;
        }

        fetchCountryCodes()
            .catch(() => [])
            .finally(() => {
                setupCountryCodeField(phoneParts.code);
                $("#phone").val(phoneParts.number || storedInfo?.phone_number || "");
            });
    }
    // Initialize the test
    function initTest() {
        const testId = getUrlParameter('test_id');
        if (testId) {
            loadTest(testId);
        } else {
            loadTestList();
        }
    }

    function loadTest(testId) {
        if (!testId) {
            showError("No test ID provided");
            return;
        }
        showLoading();
        frappe.call({
            method: "lms.placement_test.get_test_data",
            args: {
                test_id: testId
            },
            callback: function(r) {
                if (!r.exc && r.message) {
                    testData = r.message;
                    updateUrlWithTestId(testData.name);
                    timeLeft = testData.time_limit * 60; // Convert minutes to seconds
                    showTestInfo();
                } else {
                    showError("Failed to load test data");
                }
            }
        });
    }

    function loadTestList() {
        showLoading("{{ _('Fetching available tests...') }}");
        frappe.call({
            method: "lms.placement_test.list_tests",
            callback: function(r) {
                const tests = r.message || [];
                if (!r.exc && tests.length) {
                    showTestSelection(tests);
                } else {
                    showError("{{ _('No placement tests are available right now.') }}");
                }
            }
        });
    }

    function showLoading(message) {
        const container = $("#placement-test-container");
        container.html(`
            <div class="text-center py-5 placement-loading-state">
                <div class="placement-loader" role="status" aria-live="polite">
                    <span class="visually-hidden">${__('Loading...')}</span>
                </div>
                <p class="mt-3">${frappe.utils.escape_html(message || __('Loading placement test...'))}</p>
            </div>
        `);
    }

    function getTranslation(key) {
        const lang = localStorage.getItem('fli_lang') || 'en';
        const translations = {
            en: {
                choose_test: 'Choose a placement test',
                time_limit: 'Time Limit',
                minutes: 'minutes',
                start_test: 'Start This Test',
                instructions_title: 'Instructions:',
                instruction_1: 'Read each question carefully.',
                instruction_2: 'Select the correct answer(s) for each question.',
                instruction_3: 'You can skip questions and come back to them later.',
                instruction_4: 'The test will automatically submit when the time runs out.',
                instruction_5: 'Please enter your email address correctly.',
                instruction_6: 'Please enter your phone number correctly.',
                num_questions: 'Number of Questions',
                full_name: 'Full Name',
                use_legal_name: 'Use your legal name',
                date_of_birth: 'Date of Birth',
                date_format: 'Format: mm/dd/yyyy',
                email: 'Email',
                email_results: "We'll send your results here",
                preferred_time: 'Preferred Interview Time',
                choose_slot: 'Choose the slot that suits you best',
                select_time: 'Select a time slot',
                contact_number: 'Contact Number (Call & WhatsApp)',
                include_country: 'Include your country code',
                country_code: 'Country Code',
                phone_number: 'Phone Number',
                digits_only: 'Include only digits',
                start_test_btn: 'Start Test'
            },
            ar: {
                choose_test: 'Ø§Ø®ØªØ± Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰',
                time_limit: 'Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©',
                minutes: 'Ø¯Ù‚ÙŠÙ‚Ø©',
                start_test: 'Ø§Ø¨Ø¯Ø£ Ù‡Ø°Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
                instructions_title: 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª:',
                instruction_1: 'Ø§Ù‚Ø±Ø£ ÙƒÙ„ Ø³Ø¤Ø§Ù„ Ø¨Ø¹Ù†Ø§ÙŠØ©.',
                instruction_2: 'Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„.',
                instruction_3: 'ÙŠÙ…ÙƒÙ†Ùƒ ØªØ®Ø·ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„ÙŠÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹.',
                instruction_4: 'Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª.',
                instruction_5: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.',
                instruction_6: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.',
                num_questions: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©',
                full_name: 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„',
                use_legal_name: 'Ø§Ø³ØªØ®Ø¯Ù… Ø§Ø³Ù…Ùƒ Ø§Ù„Ø±Ø³Ù…ÙŠ',
                date_of_birth: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯',
                date_format: 'Ø§Ù„ØµÙŠØºØ©: ÙŠÙˆÙ…/Ø´Ù‡Ø±/Ø³Ù†Ø©',
                email: 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
                email_results: 'Ø³Ù†Ø±Ø³Ù„ Ù†ØªØ§Ø¦Ø¬Ùƒ Ù‡Ù†Ø§',
                preferred_time: 'ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© Ø§Ù„Ù…ÙØ¶Ù„',
                choose_slot: 'Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ',
                select_time: 'Ø§Ø®ØªØ± ÙˆÙ‚ØªØ§Ù‹',
                contact_number: 'Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ (Ø§ØªØµØ§Ù„ ÙˆÙˆØ§ØªØ³Ø§Ø¨)',
                include_country: 'Ø£Ø¶Ù Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©',
                country_code: 'Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©',
                phone_number: 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ',
                digits_only: 'Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·',
                start_test_btn: 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±'
            }
        };
        return (translations[lang] || translations.en)[key] || key;
    }

    function showTestSelection(tests) {
        const container = $("#placement-test-container");
        const wrapper = document.createElement("div");
        wrapper.className = "test-selection";

        const title = document.createElement("h4");
        title.className = "mb-4 text-center";
        title.setAttribute("data-i18n", "choose_test");
        title.textContent = getTranslation("choose_test");
        wrapper.appendChild(title);

        const row = document.createElement("div");
        row.className = "row";

        tests.forEach((test) => {
            const col = document.createElement("div");
            col.className = "col-md-6 mb-4";

            const card = document.createElement("div");
            card.className = "card h-100";

            const body = document.createElement("div");
            body.className = "card-body";

            const heading = document.createElement("h5");
            heading.className = "card-title";
            heading.textContent = test.test_title;

            const description = document.createElement("p");
            description.className = "card-text text-muted";
            description.innerHTML = sanitizeHtml(test.description || "");

            const metaList = document.createElement("ul");
            metaList.className = "list-unstyled small text-muted mb-3";

            const timeItem = document.createElement("li");
            timeItem.setAttribute("data-i18n-template", "time_limit");
            timeItem.dataset.timeValue = test.time_limit;
            timeItem.textContent = `${getTranslation("time_limit")}: ${test.time_limit} ${getTranslation("minutes")}`;
            metaList.appendChild(timeItem);

            const button = document.createElement("button");
            button.className = "btn btn-primary start-placement-test";
            button.setAttribute("data-i18n", "start_test");
            button.textContent = getTranslation("start_test");
            button.dataset.testId = test.name;
            button.addEventListener("click", () => loadTest(test.name));

            body.append(heading, description, metaList, button);
            card.appendChild(body);
            col.appendChild(card);
            row.appendChild(col);
        });

        wrapper.appendChild(row);
        container.empty().append(wrapper);
    }

    function updateUrlWithTestId(testId) {
        try {
            const url = new URL(window.location);
            url.searchParams.set("test_id", testId);
            window.history.replaceState({}, "", url.toString());
        } catch (error) {
            // ignore URL update errors
        }
    }
    // Show test information and start button
    function showTestInfo() {
        const container = $("#placement-test-container");
        container.html(`
            <div class="test-info">
                <h4 class="mb-4">${frappe.utils.escape_html(testData.test_title)}</h4>
                <div>${sanitizeHtml(testData.description || '')}</div>
                
                <div class="test-meta mt-4">
                    <p><strong data-i18n="num_questions">${getTranslation('num_questions')}</strong>: <span class="questions-count">${testData.questions.length}</span></p>
                    <p><strong data-i18n="time_limit">${getTranslation('time_limit')}</strong>: <span class="time-value">${testData.time_limit}</span> <span data-i18n="minutes">${getTranslation('minutes')}</span></p>
                </div>
                <div class="mt-4">
                    <h5 data-i18n="instructions_title">${getTranslation('instructions_title')}</h5>
                    <ol>
                        <li data-i18n="instruction_1">${getTranslation('instruction_1')}</li>
                        <li data-i18n="instruction_2">${getTranslation('instruction_2')}</li>
                        <li data-i18n="instruction_3">${getTranslation('instruction_3')}</li>
                        <li data-i18n="instruction_4">${getTranslation('instruction_4')}</li>
                        <li data-i18n="instruction_5">${getTranslation('instruction_5')}</li>
                        <li data-i18n="instruction_6">${getTranslation('instruction_6')}</li>
                    </ol>
                </div>
                <div class="participant-form mt-4">
                    <div class="participant-field">
                        <div class="field-label">
                            <label for="fullName" class="form-label"><span data-i18n="full_name">${getTranslation('full_name')}</span> <span class="text-danger">*</span></label>
                            <small class="text-muted" data-i18n="use_legal_name">${getTranslation('use_legal_name')}</small>
                        </div>
                        <div class="field-input">
                            <input type="text" class="form-control" id="fullName" required>
                        </div>
                    </div>
                    <div class="participant-field">
                        <div class="field-label">
                            <label for="dateOfBirth" class="form-label"><span data-i18n="date_of_birth">${getTranslation('date_of_birth')}</span> <span class="text-danger">*</span></label>
                            <small class="text-muted" data-i18n="date_format">${getTranslation('date_format')}</small>
                        </div>
                        <div class="field-input">
                            <input type="date" class="form-control" id="dateOfBirth" required>
                        </div>
                    </div>
                    <div class="participant-field">
                        <div class="field-label">
                            <label for="email" class="form-label"><span data-i18n="email">${getTranslation('email')}</span> <span class="text-danger">*</span></label>
                            <small class="text-muted" data-i18n="email_results">${getTranslation('email_results')}</small>
                        </div>
                        <div class="field-input">
                            <input type="email" class="form-control" id="email" placeholder="name@example.com" required>
                        </div>
                    </div>
                    <div class="participant-field">
                        <div class="field-label">
                            <label for="interviewTime" class="form-label"><span data-i18n="preferred_time">${getTranslation('preferred_time')}</span> <span class="text-danger">*</span></label>
                            <small class="text-muted" data-i18n="choose_slot">${getTranslation('choose_slot')}</small>
                        </div>
                        <div class="field-input">
                            <select id="interviewTime" class="form-select" required>
                                <option value="" data-i18n="select_time">${getTranslation('select_time')}</option>
                                <option value="9-10 AM">9-10 AM</option>
                                <option value="1-2 PM">1-2 PM</option>
                                <option value="4-5 PM">4-5 PM</option>
                                <option value="8-9 PM">8-9 PM</option>
                            </select>
                        </div>
                    </div>
                    <div class="participant-field">
                        <div class="field-label">
                            <label class="form-label mb-0 d-block"><span data-i18n="contact_number">${getTranslation('contact_number')}</span> <span class="text-danger">*</span></label>
                            <small class="text-muted" data-i18n="include_country">${getTranslation('include_country')}</small>
                        </div>
                        <div class="field-input">
                            <div class="country-contact-row">
                                <div class="contact-field-stack">
                                    <div class="form-control-wrap">
                                        <label for="countryCode" class="form-label" data-i18n="country_code">${getTranslation('country_code')}</label>
                                        <div class="contact-input">
                                            <div id="countryCodeField"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="contact-field-stack">
                                    <div class="form-control-wrap">
                                        <label for="phone" class="form-label" data-i18n="phone_number">${getTranslation('phone_number')}</label>
                                        <div class="contact-input">
                                            <input type="tel" class="form-control" id="phone" required>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-4">
                    <button class="btn btn-primary btn-lg" id="start-test-btn" data-i18n="start_test_btn">
                        ${getTranslation('start_test_btn')}
                    </button>
                </div>
            </div>
        `);
        initializeParticipantForm();

        $("#start-test-btn").on("click", function() {
            const fullName = $("#fullName").val().trim();
            const dateOfBirth = $("#dateOfBirth").val();
            const email = $("#email").val().trim();
            const phone = $("#phone").val().trim();
            const interviewTime = $("#interviewTime").val();
            const countryCode = ($("#countryCode").val() || "").trim();
            if (!fullName || !dateOfBirth || !email || !interviewTime || !phone || !countryCode) {
                frappe.msgprint(__("Please fill in all required fields, including your preferred interview time and country code."));
                return;
            }
            const formattedPhone = `${countryCode} ${phone}`.replace(/\s+/g, " ").trim();
            const submissionInfo = { fullName, dateOfBirth, email, phone: formattedPhone, interviewTime };
            localStorage.setItem("placementTestUserInfo", JSON.stringify(submissionInfo));
            startTest(fullName, dateOfBirth, email, formattedPhone, interviewTime);
        });
    }
    // Start the test
    function startTest(fullName, dateOfBirth, email, phone, interviewTime) {
        // Create test submission
        frappe.call({
            method: "lms.placement_test.create_test_submission",
            args: {
                test_id: testData.name,
                full_name: fullName,
                date_of_birth: dateOfBirth,
                email: email,
                phone: phone,
                interview_time: interviewTime
            },
            callback: function(r) {
                if (!r.exc && r.message) {
                    testData.submission_id = r.message;
                    showQuestion(0);
                    startTimer();
                } else {
                    showError("Failed to start test");
                }
            }
        });
    }
    // Show a specific question
    function showQuestion(index) {
        if (index < 0 || index >= testData.questions.length) {
            return;
        }
        currentQuestion = index;
        const question = testData.questions[index];
        const userAnswer = userAnswers[index] || [];
        // Build options HTML
        let optionsHtml = '';
        question.options.forEach((option, i) => {
            const isChecked = userAnswer.includes(i) ? 'checked' : '';
            optionsHtml += `
                <div class="form-check mb-2">
                    <input class="form-check-input" type="${question.question_type === 'Single Answer' ? 'radio' : 'checkbox'}" 
                           name="q${index}" id="option-${index}-${i}" value="${i}" ${isChecked}>
                    <label class="form-check-label" for="option-${index}-${i}">
                        ${frappe.utils.escape_html(option.option_text)}
                    </label>
                </div>
            `;
        });
        // Build navigation buttons
        let navButtons = '';
        if (index > 0) {
            navButtons += `<button class="btn btn-secondary me-2" id="prev-btn">${__('Previous')}</button>`;
        }
        if (index < testData.questions.length - 1) {
            navButtons += `<button class="btn btn-primary" id="next-btn">${__('Next')}</button>`;
        } else {
            navButtons += `<button class="btn btn-success" id="submit-btn">${__('Submit Test')}</button>`;
        }
        // Update the container
        $("#placement-test-container").html(`
            <div class="test-header d-flex justify-content-between align-items-center mb-4">
                <h4>${__('Question')} ${index + 1} ${__('of')} ${testData.questions.length}</h4>
                <div class="time-remaining" id="time-remaining"></div>
            </div>
            <div class="question-container">
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">${frappe.utils.escape_html(question.question)}</h5>
                        <div class="options-container mt-3">
                            ${optionsHtml}
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-4">
                    <div>
                        ${navButtons}
                    </div>
                    <div>
                        <button class="btn btn-outline-secondary" id="save-btn">
                            ${__('Save & Next')}
                        </button>
                    </div>
                </div>
            </div>
        `);
        // Add event listeners
        if (index > 0) {
            $("#prev-btn").on("click", function() {
                saveAnswer(index);
                showQuestion(index - 1);
            });
        }
        if (index < testData.questions.length - 1) {
            $("#next-btn").on("click", function() {
                saveAnswer(index);
                showQuestion(index + 1);
            });
        } else {
            $("#submit-btn").on("click", function() {
                if (confirm(__("Are you sure you want to submit the test?"))) {
                    submitTest();
                }
            });
        }
        $("#save-btn").on("click", function() {
            saveAnswer(index);
            if (index < testData.questions.length - 1) {
                showQuestion(index + 1);
            }
        });
    }
    // Save the current answer
    function saveAnswer(index) {
        const question = testData.questions[index];
        const selected = [];
        
        if (question.question_type === 'Single Answer') {
            const selectedOption = $(`input[name="q${index}"]:checked`).val();
            if (selectedOption !== undefined) {
                selected.push(parseInt(selectedOption));
            }
        } else {
            $(`input[name="q${index}"]:checked`).each(function() {
                selected.push(parseInt($(this).val()));
            });
        }
        userAnswers[index] = selected;
    }
    // Start the test timer
    function startTimer() {
        updateTimerDisplay();
        timer = setInterval(function() {
            timeLeft--;
            updateTimerDisplay();
            if (timeLeft <= 0) {
                clearInterval(timer);
                submitTest();
            }
        }, 1000);
    }
    // Update the timer display
    function updateTimerDisplay() {
        if (timeLeft <= 0) {
            $("#time-remaining").html(`
                <span class="badge bg-danger">${__('Time\'s up!')}</span>
            `);
            return;
        }
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        $("#time-remaining").html(`
            <span class="badge bg-primary">
                ${__('Time Left')}: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}
            </span>
        `);
    }
    // Submit the test
    function loadSubmissionInfo() {
        const stored = localStorage.getItem("placementTestUserInfo");
        if (!stored) return null;
        try {
            return JSON.parse(stored);
        } catch (error) {
            return null;
        }
    }

    function submitTest() {
        clearInterval(timer);
        
        // Save the last answer
        saveAnswer(currentQuestion);
        // Prepare answers
        const answers = [];
        testData.questions.forEach((question, index) => {
            answers.push({
                question: question.name,
                selected_options: JSON.stringify(userAnswers[index] || [])
            });
        });
        // Submit to server
        const submissionInfo = loadSubmissionInfo();
        const payload = {
            submission_id: testData.submission_id,
            answers: answers,
        };

        if (submissionInfo) {
            payload.full_name = submissionInfo.fullName;
            payload.date_of_birth = submissionInfo.dateOfBirth;
            payload.email = submissionInfo.email;
            payload.phone = submissionInfo.phone;
        }

        frappe.call({
            method: "lms.placement_test.submit_test_answers",
            args: payload,
            freeze: true,
            callback: function(r) {
                if (!r.exc && r.message) {
                    // Get user info before removing from localStorage
                    const userInfo = JSON.parse(localStorage.getItem("placementTestUserInfo") || "{}");
                    localStorage.removeItem("placementTestUserInfo");
                    showTestResult(r.message, userInfo);
                } else {
                    showError("Failed to submit test");
                }
            }
        });
    }
    // Show test result
    function showTestResult(result, userInfo) {
        userInfo = userInfo || {};
        const studentName = userInfo.fullName || "";
        const interviewTime = userInfo.interviewTime || "";
        const lang = localStorage.getItem('fli_lang') || 'en';
        
        // Get translations based on current language
        const dict = footerTranslations[lang] || footerTranslations.en;
        
        // Build result summary with speaking evaluation confirmation
        const summaryHtml = `
            <div class="result-summary mb-5">
                <h3 class="mb-4" data-i18n="result_title">${dict.result_title || 'Speaking Evaluation Appointment Confirmation â€“ FLI'}</h3>
                <div class="confirmation-message" style="background: #f8f9fa; border-radius: 16px; padding: 30px; max-width: 700px; margin: 0 auto;">
                    <p style="font-size: 18px; margin-bottom: 20px;">
                        <span data-i18n="result_greeting">${dict.result_greeting || 'Hello'}</span> <strong>${frappe.utils.escape_html(studentName)}</strong>${lang === 'ar' ? 'ØŒ' : ','}
                    </p>
                    <p data-i18n="result_thanks">${dict.result_thanks || 'Thank you for completing the placement test at Faculty Language Institute (FLI).'}</p>
                    <p data-i18n="result_booked">${dict.result_booked || 'We are pleased to inform you that a short speaking evaluation has been scheduled with one of our instructors.'}</p>
                    
                    <div style="background: #e8f4fd; border-radius: 12px; padding: 20px; margin: 20px 0;">
                        <p style="margin: 0;"><strong>â° <span data-i18n="result_time">${dict.result_time || 'Time'}</span>:</strong> ${frappe.utils.escape_html(interviewTime)}</p>
                        <p style="margin: 10px 0 0;" data-i18n="result_via_zoom">${dict.result_via_zoom || 'Via: Zoom â€“ Please check your email and attend at the exact scheduled time'}</p>
                    </div>
                    
                    <p data-i18n="result_duration">${dict.result_duration || 'The evaluation takes only 5â€“7 minutes and aims to accurately determine your level and help you choose the right course.'}</p>
                    
                    <p>${lang === 'ar' ? 'ÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… Ø§Ù„ØªÙØ±Øº ÙÙŠ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„Ø±Ù‚Ù…' : 'If you are unavailable at the scheduled time, please contact us at'} <strong style="direction: ltr; display: inline-block;">781405000</strong> ${lang === 'ar' ? 'Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©.' : 'to reschedule.'}</p>
                    
                    <p data-i18n="result_wish">${dict.result_wish || 'We wish you a great learning experience with FLI.'}</p>
                    
                    <p style="margin-top: 30px;">
                        <span data-i18n="result_regards">${dict.result_regards || 'Best regards,'}</span><br>
                        <strong data-i18n="result_admin">${dict.result_admin || 'Faculty Language Institute Administration'}</strong>
                    </p>
                </div>
                <div class="mt-4">
                    <a href="/" class="btn btn-primary" data-i18n="back_home">${dict.back_home || 'Back to Home'}</a>
                </div>
            </div>
        `;
        // Update the container
        $("#placement-test-container").html(summaryHtml);
        // Apply RTL/LTR styling based on language
        applyPlacementTranslations(lang);
    }
    // Show error message
    function showError(message) {
        $("#placement-test-container").html(`
            <div class="alert alert-danger" role="alert">
                ${frappe.utils.escape_html(message)}
            </div>
            <div class="text-center mt-3">
                <a href="/" class="btn btn-primary">${__('Back to Home')}</a>
            </div>
        `);
    }
    // Helper function to get URL parameters
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        const results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
    // Initialize the test when the page loads
    initTest();
});

// Mobile menu toggle
function toggleMobileMenu() {
    const hamburger = document.querySelector('.hamburger');
    const mobileMenu = document.getElementById('mobileMenu');
    hamburger.classList.toggle('active');
    mobileMenu.classList.toggle('active');
}

// Close mobile menu when clicking outside
document.addEventListener('click', function(e) {
    const hamburger = document.querySelector('.hamburger');
    const mobileMenu = document.getElementById('mobileMenu');
    if (hamburger && mobileMenu && !hamburger.contains(e.target) && !mobileMenu.contains(e.target)) {
        hamburger.classList.remove('active');
        mobileMenu.classList.remove('active');
    }
}); 

// Language toggle
let currentLang = localStorage.getItem('fli_lang') || 'en';

const footerTranslations = {
    en: {
        footer_address: "Faculty Language Institute (FLI) â€” Baghdad Street, Sana'a",
        footer_contact: 'Contact',
        footer_email: 'Email: facultyinstitutefli@gmail.com',
        footer_phone: 'Phone: +967 777 577 222',
        footer_copyright: 'Faculty Language Institute. All rights reserved.',
        placement_main_title: 'English Level Placement Test',
        placement_subtitle: 'Start at the right level for you, and learn with confidence and proper methodology.',
        placement_why_title: 'Why is the placement test important?',
        placement_why_1: 'Accurately determines your real level',
        placement_why_2: 'Saves you time and effort',
        placement_why_3: 'Places you directly in the appropriate course',
        placement_how_title: 'How does the test work?',
        placement_step_1: 'Register your basic information',
        placement_step_2: 'Complete the online test',
        placement_step_3: 'Short interview with one of our instructors to assess speaking skills',
        placement_step_4: 'Accurate final level determination',
        placement_remote: 'ğŸ“ Available: Fully remote',
        placement_interview_title: 'What does the interview evaluate?',
        placement_interview_1: 'Speaking fluency',
        placement_interview_2: 'Pronunciation',
        placement_interview_3: 'Communication ability',
        placement_interview_4: 'Vocabulary usage',
        placement_interview_note: 'The interview aims to help you, not a formal exam.',
        placement_levels_title: 'Levels covered by the test:',
        levels_beginner_title: 'Levels covered by Beginner test:',
        levels_intermediate_title: 'Levels covered by Intermediate test:',
        levels_graduation_title: 'Levels covered by Graduation test:',
        choose_test: 'Choose a placement test',
        time_limit: 'Time Limit',
        minutes: 'minutes',
        start_test: 'Start This Test',
        instructions_title: 'Instructions:',
        instruction_1: 'Read each question carefully.',
        instruction_2: 'Select the correct answer(s) for each question.',
        instruction_3: 'You can skip questions and come back to them later.',
        instruction_4: 'The test will automatically submit when the time runs out.',
        instruction_5: 'Please enter your email address correctly.',
        instruction_6: 'Please enter your phone number correctly.',
        num_questions: 'Number of Questions',
        full_name: 'Full Name',
        use_legal_name: 'Use your legal name',
        date_of_birth: 'Date of Birth',
        date_format: 'Format: mm/dd/yyyy',
        email: 'Email',
        email_results: "We'll send your results here",
        preferred_time: 'Preferred Interview Time',
        choose_slot: 'Choose the slot that suits you best',
        select_time: 'Select a time slot',
        contact_number: 'Contact Number (Call & WhatsApp)',
        include_country: 'Include your country code',
        country_code: 'Country Code',
        phone_number: 'Phone Number',
        start_test_btn: 'Start Test',
        result_title: 'Speaking Evaluation Appointment Confirmation â€“ FLI',
        result_greeting: 'Hello',
        result_thanks: 'Thank you for completing the placement test at Faculty Language Institute (FLI).',
        result_booked: 'We are pleased to inform you that a short speaking evaluation has been scheduled with one of our instructors.',
        result_time: 'Time',
        result_via_zoom: 'Via: Zoom â€“ Please check your email and attend at the exact scheduled time',
        result_duration: 'The evaluation takes only 5â€“7 minutes and aims to accurately determine your level and help you choose the right course.',
        result_reschedule: 'If you are unavailable at the scheduled time, please contact us at 781405000 to reschedule.',
        result_wish: 'We wish you a great learning experience with FLI.',
        result_regards: 'Best regards,',
        result_admin: 'Faculty Language Institute Administration',
        back_home: 'Back to Home'
    },
    ar: {
        footer_address: 'Ù…Ø¹Ù‡Ø¯ ÙØ§ÙƒÙ„ØªÙŠ Ù„Ù„ØºØ§Øª (FLI) â€” Ø´Ø§Ø±Ø¹ Ø¨ØºØ¯Ø§Ø¯ØŒ ØµÙ†Ø¹Ø§Ø¡',
        footer_contact: 'Ø§Ù„ØªÙˆØ§ØµÙ„',
        footer_email: 'Ø§Ù„Ø¨Ø±ÙŠØ¯: facultyinstitutefli@gmail.com',
        footer_phone: 'Ø§Ù„Ù‡Ø§ØªÙ: +967 777 577 222',
        footer_copyright: 'Ù…Ø¹Ù‡Ø¯ ÙØ§ÙƒÙ„ØªÙŠ Ù„Ù„ØºØ§Øª. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.',
        placement_main_title: 'Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©',
        placement_subtitle: 'Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„ÙƒØŒ ÙˆØªØ¹Ù„Ù‘Ù… Ø¨Ø«Ù‚Ø© ÙˆÙ…Ù†Ù‡Ø¬ÙŠØ© ØµØ­ÙŠØ­Ø©.',
        placement_why_title: 'Ù„Ù…Ø§Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ù…Ù‡Ù…ØŸ',
        placement_why_1: 'ÙŠØ­Ø¯Ø¯ Ù…Ø³ØªÙˆØ§Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ø¯Ù‚Ø©',
        placement_why_2: 'ÙŠÙˆÙÙ‘Ø± Ø¹Ù„ÙŠÙƒ Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¬Ù‡Ø¯',
        placement_why_3: 'ÙŠØ¶Ø¹Ùƒ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù…Ø¨Ø§Ø´Ø±Ø©',
        placement_how_title: 'ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŸ',
        placement_step_1: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©',
        placement_step_2: 'Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
        placement_step_3: 'Ù…Ù‚Ø§Ø¨Ù„Ø© Ù‚ØµÙŠØ±Ø© Ù…Ø¹ Ø£Ø­Ø¯ Ù…Ø¯Ø±Ù‘Ø³ÙŠ Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ù„ØªÙ‚ÙŠÙŠÙ… Ù…Ù‡Ø§Ø±Ø© Ø§Ù„ØªØ­Ø¯Ø«',
        placement_step_4: 'ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø¯Ù‚Ø©',
        placement_remote: 'ğŸ“ Ù…ØªØ§Ø­: Ø¹Ù† Ø¨ÙØ¹Ø¯ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„',
        placement_interview_title: 'Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªÙ‚ÙŠÙ‘Ù…Ù‡ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø©ØŸ',
        placement_interview_1: 'Ø§Ù„Ø·Ù„Ø§Ù‚Ø© ÙÙŠ Ø§Ù„ØªØ­Ø¯Ø«',
        placement_interview_2: 'Ø§Ù„Ù†Ø·Ù‚',
        placement_interview_3: 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„',
        placement_interview_4: 'Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª',
        placement_interview_note: 'Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© ØªÙ‡Ø¯Ù Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŒ ÙˆÙ„ÙŠØ³Øª Ø§Ù…ØªØ­Ø§Ù†Ù‹Ø§ Ø±Ø³Ù…ÙŠÙ‹Ø§.',
        placement_levels_title: 'Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªÙŠ ÙŠØºØ·ÙŠÙ‡Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:',
        levels_beginner_title: 'Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªÙŠ ÙŠØºØ·ÙŠÙ‡Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†:',
        levels_intermediate_title: 'Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªÙŠ ÙŠØºØ·ÙŠÙ‡Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ØªÙˆØ³Ø·:',
        levels_graduation_title: 'Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªÙŠ ÙŠØºØ·ÙŠÙ‡Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ®Ø±Ø¬:',
        choose_test: 'Ø§Ø®ØªØ± Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰',
        time_limit: 'Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©',
        minutes: 'Ø¯Ù‚ÙŠÙ‚Ø©',
        start_test: 'Ø§Ø¨Ø¯Ø£ Ù‡Ø°Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
        instructions_title: 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª:',
        instruction_1: 'Ø§Ù‚Ø±Ø£ ÙƒÙ„ Ø³Ø¤Ø§Ù„ Ø¨Ø¹Ù†Ø§ÙŠØ©.',
        instruction_2: 'Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„.',
        instruction_3: 'ÙŠÙ…ÙƒÙ†Ùƒ ØªØ®Ø·ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„ÙŠÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹.',
        instruction_4: 'Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª.',
        instruction_5: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.',
        instruction_6: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.',
        num_questions: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©',
        full_name: 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„',
        use_legal_name: 'Ø§Ø³ØªØ®Ø¯Ù… Ø§Ø³Ù…Ùƒ Ø§Ù„Ø±Ø³Ù…ÙŠ',
        date_of_birth: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯',
        date_format: 'Ø§Ù„ØµÙŠØºØ©: ÙŠÙˆÙ…/Ø´Ù‡Ø±/Ø³Ù†Ø©',
        email: 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
        email_results: 'Ø³Ù†Ø±Ø³Ù„ Ù†ØªØ§Ø¦Ø¬Ùƒ Ù‡Ù†Ø§',
        preferred_time: 'ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© Ø§Ù„Ù…ÙØ¶Ù„',
        choose_slot: 'Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ',
        select_time: 'Ø§Ø®ØªØ± ÙˆÙ‚ØªØ§Ù‹',
        contact_number: 'Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ (Ø§ØªØµØ§Ù„ ÙˆÙˆØ§ØªØ³Ø§Ø¨)',
        include_country: 'Ø£Ø¶Ù Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©',
        country_code: 'Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©',
        phone_number: 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ',
        start_test_btn: 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±',
        result_title: 'ØªØ£ÙƒÙŠØ¯ Ù…ÙˆØ¹Ø¯ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ­Ø¯Ø« â€“ Ù…Ø¹Ù‡Ø¯ FLI',
        result_greeting: 'Ù…Ø±Ø­Ø¨Ù‹Ø§',
        result_thanks: 'Ø´ÙƒØ±Ù‹Ø§ Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙÙŠ Ù…Ø¹Ù‡Ø¯ Faculty Language Institute (FLI).',
        result_booked: 'ÙŠØ³Ø±Ù‘Ù†Ø§ Ø¥Ø¨Ù„Ø§ØºÙƒ Ø¨Ø£Ù†Ù‡ ØªÙ… Ø­Ø¬Ø² ØªÙ‚ÙŠÙŠÙ… Ù‚ØµÙŠØ± Ù„Ù…Ù‡Ø§Ø±Ø© Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ø£Ø­Ø¯ Ù…Ø¯Ø±Ù‘Ø³ÙŠ Ø§Ù„Ù…Ø¹Ù‡Ø¯.',
        result_time: 'Ø§Ù„ÙˆÙ‚Øª',
        result_via_zoom: 'Ø¹Ø¨Ø±: Ø§Ù„Ø²ÙˆÙ… â€“ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡ Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙˆØ§Ù„Ø­Ø¶ÙˆØ± Ø¨Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ ØªÙ…Ø§Ù…Ø§Ù‹',
        result_duration: 'Ù…Ø¯Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù„Ø§ ØªØªØ¬Ø§ÙˆØ² 5â€“7 Ø¯Ù‚Ø§Ø¦Ù‚ØŒ ÙˆÙŠÙ‡Ø¯Ù ÙÙ‚Ø· Ø¥Ù„Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³ØªÙˆØ§Ùƒ Ø¨Ø¯Ù‚Ø© ÙˆÙ…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¹Ù„Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©.',
        result_reschedule: 'ÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… Ø§Ù„ØªÙØ±Øº ÙÙŠ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„Ø±Ù‚Ù… 781405000 Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©.',
        result_wish: 'Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ØªØ¬Ø±Ø¨Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ù…ÙŠØ²Ø© Ù…Ø¹ FLI.',
        result_regards: 'Ù…Ø¹ Ø®Ø§Ù„Øµ Ø§Ù„ØªØ­ÙŠØ©ØŒ',
        result_admin: 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¹Ù‡Ø¯ Faculty Language Institute',
        back_home: 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©'
    }
};

function applyPlacementTranslations(lang) {
    const wrapper = document.getElementById('placement-wrapper');
    if (wrapper) {
        wrapper.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
    }
    // Update info section direction
    const infoSection = document.querySelector('.placement-info-section');
    if (infoSection) {
        infoSection.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
        infoSection.style.textAlign = lang === 'ar' ? 'right' : 'left';
    }
    // Update test selection direction
    const testSelection = document.querySelector('.test-selection');
    if (testSelection) {
        testSelection.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
        testSelection.style.textAlign = lang === 'ar' ? 'right' : 'left';
    }
    // Update test info direction
    const testInfo = document.querySelector('.test-info');
    if (testInfo) {
        testInfo.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
        testInfo.style.textAlign = lang === 'ar' ? 'right' : 'left';
    }
    // Update result summary direction
    const resultSummary = document.querySelector('.result-summary');
    if (resultSummary) {
        resultSummary.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
        resultSummary.style.textAlign = lang === 'ar' ? 'right' : 'left';
    }
    // Update confirmation message direction
    const confirmationMessage = document.querySelector('.confirmation-message');
    if (confirmationMessage) {
        confirmationMessage.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
        confirmationMessage.style.textAlign = lang === 'ar' ? 'right' : 'left';
    }
    document.querySelectorAll('.lang-switcher').forEach((btn) => {
        btn.textContent = lang === 'en' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'English';
    });
    const dict = footerTranslations[lang] || footerTranslations.en;
    document.querySelectorAll('[data-i18n]').forEach((el) => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) {
            el.textContent = dict[key];
        }
    });
    // Handle time limit template
    document.querySelectorAll('[data-i18n-template="time_limit"]').forEach((el) => {
        const timeValue = el.dataset.timeValue || '';
        el.textContent = `${dict.time_limit || 'Time Limit'}: ${timeValue} ${dict.minutes || 'minutes'}`;
    });
    document.getElementById('year-placement')?.replaceChildren(new Date().getFullYear());
}

function toggleLang() {
    currentLang = currentLang === 'en' ? 'ar' : 'en';
    applyPlacementTranslations(currentLang);
    localStorage.setItem('fli_lang', currentLang);
}

// Alias for onclick handler
function toggleLanguage() {
    toggleLang();
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', function() {
    applyPlacementTranslations(currentLang);
});
</script>
{% endblock %}
{% block style %}
<style>
    .test-info {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    .test-info h4 {
        color: #1a1a2e;
        font-weight: 700;
        font-size: 24px;
    }
    .test-meta p {
        color: #6b7280;
        margin-bottom: 8px;
    }
    .test-meta strong {
        color: #1a1a2e;
    }
    .test-info h5 {
        color: #1a1a2e;
        font-weight: 600;
    }
    .test-info ol {
        color: #6b7280;
    }
    .participant-form {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        padding: 1.5rem;
        border: 1px solid rgba(11, 95, 255, 0.1);
        border-radius: 16px;
        background: linear-gradient(135deg, rgba(232, 244, 253, 0.5), rgba(255, 255, 255, 0.95));
        box-shadow: 0 10px 30px rgba(9, 30, 66, 0.06);
    }
    .participant-field {
        display: flex;
        flex-direction: column;
        gap: 0.35rem;
    }
    .field-label {
        display: flex;
        flex-direction: column;
        gap: 0.1rem;
    }
    .field-label .form-label {
        margin-bottom: 0;
        font-weight: 600;
        color: #1a1a2e;
    }
    .field-input .form-control,
    .field-input input,
    .field-input select {
        border: 1px solid rgba(11, 95, 255, 0.15);
        border-radius: 10px;
        padding: 0.75rem 1rem;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
        font-size: 15px;
    }
    .field-input .form-control:focus,
    .field-input input:focus,
    .field-input select:focus {
        border-color: #0b5fff;
        box-shadow: 0 0 0 3px rgba(11, 95, 255, 0.15);
        outline: none;
    }
    .participant-form small {
        color: #6b7280;
        font-size: 0.82rem;
    }
    .country-contact-row {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        width: 100%;
    }
    .contact-field-stack {
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    .form-control-wrap {
        display: flex;
        flex-direction: column;
        gap: 0.35rem;
    }
    .contact-input {
        width: 100%;
    }
    .contact-input .form-control,
    .contact-input input {
        width: 100%;
    }
    @media (min-width: 768px) {
        .country-contact-row {
            flex-direction: row;
            align-items: flex-end;
        }
    }
    @media (min-width: 768px) {
        .participant-field {
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
        }
        .participant-field .field-label {
            flex: 0 0 40%;
        }
        .participant-field .field-input {
            flex: 1;
        }
    }
    .country-contact-row .form-label {
        font-weight: 600;
    }
    .country-code-dropdown {
        position: relative;
        width: 100%;
    }
    .country-code-trigger {
        width: 100%;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        border: 1px solid rgba(11, 95, 255, 0.15);
        border-radius: 10px;
        padding: 0.75rem 1rem;
        background: #fff;
        color: #1a1a2e;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .country-code-trigger:focus-visible {
        outline: none;
        border-color: #0b5fff;
        box-shadow: 0 0 0 3px rgba(11, 95, 255, 0.15);
    }
    .country-code-trigger .flag-thumb {
        width: 24px;
        height: 18px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f8f9fa;
        border-radius: 4px;
        overflow: hidden;
    }
    .country-code-trigger .flag-thumb img {
        width: 100%;
        height: auto;
        display: block;
    }
    .country-code-trigger .country-code-text {
        flex: 1;
        text-align: left;
        font-weight: 600;
        font-size: 0.95rem;
    }
    .country-code-trigger .chevron {
        font-size: 0.9rem;
        color: #6c757d;
    }
    .country-code-menu {
        position: absolute;
        top: calc(100% + 6px);
        left: 0;
        width: 100%;
        background: #fff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 0.35rem;
        box-shadow: 0 18px 30px rgba(15, 23, 42, 0.15);
        z-index: 20;
        padding: 0.75rem;
    }
    .country-code-search {
        margin-bottom: 0.5rem;
    }
    .country-code-options {
        max-height: 280px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 0.35rem;
    }
    .country-code-option {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        width: 100%;
        border: 1px solid transparent;
        border-radius: 0.35rem;
        padding: 0.5rem 0.75rem;
        background: #f8f9fa;
        text-align: left;
        transition: all 0.2s ease;
        cursor: pointer;
    }
    .country-code-option:hover,
    .country-code-option:focus-visible {
        border-color: #0b5fff;
        background: rgba(11, 95, 255, 0.08);
        outline: none;
    }
    .country-code-option .flag-thumb {
        width: 24px;
        height: 18px;
        border-radius: 4px;
        background: #fff;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        border: 1px solid rgba(0, 0, 0, 0.08);
    }
    .country-code-option .flag-thumb img {
        width: 100%;
        height: auto;
    }
    .country-code-copy {
        display: flex;
        flex-direction: column;
        line-height: 1.1;
    }
    .country-code-copy .country-dial {
        font-weight: 600;
    }
    .country-code-copy .country-name {
        font-size: 0.85rem;
        color: #6c757d;
    }
    .country-code-dropdown.open .country-code-trigger {
        border-bottom-left-radius: 0.35rem;
        border-bottom-right-radius: 0.35rem;
    }
    .placeholder-country-code {
        border: 1px dashed rgba(0, 0, 0, 0.1);
        border-radius: 0.35rem;
        padding: 0.5rem 0.75rem;
    }
    .question-container {
        max-width: 800px;
        margin: 0 auto;
    }
    .question-container .card {
        border: none;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(9, 30, 66, 0.06);
    }
    .question-container .card-body {
        padding: 24px;
    }
    .question-container .card-title {
        color: #1a1a2e;
        font-weight: 600;
        font-size: 18px;
        line-height: 1.5;
    }
    .time-remaining {
        font-size: 1.1rem;
        font-weight: bold;
    }
    .time-remaining .badge {
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 14px;
        color: #fff;
    }
    .badge.bg-primary {
        background: #0b5fff !important;
    }
    .badge.bg-danger {
        background: #dc3545 !important;
    }
    /* Result summary RTL/LTR styling */
    .result-summary {
        direction: ltr;
        text-align: left;
    }
    .confirmation-message {
        direction: ltr;
        text-align: left;
    }
    [dir="rtl"] .result-summary {
        direction: rtl;
        text-align: right;
    }
    [dir="rtl"] .confirmation-message {
        direction: rtl;
        text-align: right;
    }
    .score-circle {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 2.5rem;
        font-weight: bold;
        margin: 0 auto 20px;
        background: linear-gradient(135deg, #0b5fff 0%, #0947cc 100%);
        box-shadow: 0 10px 30px rgba(11, 95, 255, 0.3);
    }
    .score {
        font-size: 2.5rem;
    }
    .form-check-input {
        margin-top: 0.25rem;
        width: 18px;
        height: 18px;
    }
    .form-check-input:checked {
        background-color: #0b5fff;
        border-color: #0b5fff;
    }
    .form-check-input:focus {
        box-shadow: 0 0 0 3px rgba(11, 95, 255, 0.15);
        border-color: #0b5fff;
    }
    .form-check-label {
        color: #1a1a2e;
        font-size: 15px;
        padding-left: 8px;
    }
    .form-check {
        display: flex;
        align-items: flex-start;
        gap: 10px;
    }
    /* Keep question container always LTR */
    .question-container,
    .question-container * {
        direction: ltr !important;
        text-align: left !important;
    }
    .test-header {
        direction: ltr !important;
    }
    .explanation {
        background-color: #e8f4fd;
        padding: 15px;
        border-radius: 10px;
        border-right: 4px solid #0b5fff;
    }
    .btn-primary {
        background: #0b5fff !important;
        border-color: #0b5fff !important;
        border-radius: 25px;
        padding: 10px 24px;
        font-weight: 600;
        transition: all 0.2s;
    }
    .btn-primary:hover {
        background: #0947cc !important;
        border-color: #0947cc !important;
        transform: translateY(-1px);
    }
    .btn-secondary {
        border-radius: 25px;
        padding: 10px 24px;
        font-weight: 600;
    }
    .btn-success {
        background: #10b981 !important;
        border-color: #10b981 !important;
        border-radius: 25px;
        padding: 10px 24px;
        font-weight: 600;
    }
    .btn-success:hover {
        background: #059669 !important;
        border-color: #059669 !important;
    }
    .btn-outline-secondary {
        border-radius: 25px;
        padding: 10px 24px;
        font-weight: 600;
        border-color: #e5e7eb;
        color: #6b7280;
    }
    .btn-outline-secondary:hover {
        border-color: #0b5fff;
        color: #0b5fff;
        background: transparent;
    }
    .test-header h4 {
        color: #1a1a2e;
        font-weight: 700;
    }
    .result-summary h3 {
        color: #1a1a2e;
        font-weight: 700;
    }
    .result-summary .card {
        border: none;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(9, 30, 66, 0.06);
    }
    .result-summary .card-title {
        color: #1a1a2e;
        font-weight: 600;
    }
    .result-summary .table {
        margin-bottom: 0;
    }
    .result-summary .table td {
        padding: 12px 16px;
        color: #6b7280;
    }
    .result-summary .table td:last-child {
        color: #1a1a2e;
        font-weight: 600;
    }
    .test-selection h4 {
        color: #1a1a2e;
        font-weight: 700;
    }
    .test-selection .card {
        border: none;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(9, 30, 66, 0.06);
        transition: all 0.2s;
    }
    .test-selection .card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 30px rgba(9, 30, 66, 0.1);
    }
    .test-selection .card-title {
        color: #1a1a2e;
        font-weight: 600;
    }
    .start-placement-test {
        white-space: nowrap;
        width: auto;
        min-width: 180px;
        padding: 14px 32px;
        font-size: 15px;
        display: block;
        margin: 0 auto;
    }
    .alert-danger {
        background: #fef2f2;
        border: 1px solid #fecaca;
        border-radius: 12px;
        color: #dc2626;
    }
    @media (max-width: 768px) {
        .score-circle {
            width: 120px;
            height: 120px;
            font-size: 2rem;
        }
        
        .score {
            font-size: 2rem;
        }
    }
</style>
{% endblock %}